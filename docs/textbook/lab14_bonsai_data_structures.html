<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 14: Bonsai Data Structures | Computational Genetic Genealogy</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body class="textbook-page">
    <header class="textbook-header">
        <div class="container">
            <h1>Computational Genetic Genealogy</h1>
            <p>Data Structures and Algorithmic Design in Bonsai</p>
        </div>
    </header>

    <nav class="textbook-nav">
        <div class="container">
            <a href="../index.html"><i class="fas fa-arrow-left"></i> Back to Main Page</a>
            <a href="contents.html">Table of Contents</a>
            <a href="lab14_bonsai_data_structures.html" class="active">Lab 14 bonsai data structures</a>
        </div>
    </nav>

    <main class="container">
        <article class="section lab-content">
            <h2>Lab 14: Data Structures and Algorithmic Design in Bonsai v3</h2>
            
            <div class="alert alert-info">
                <p><strong>Why This Matters:</strong> Data structures are more than technical implementations—they are conceptual frameworks that shape how we organize, access, and interpret information about human relationships. In Bonsai v3, the chosen data structures embody particular understandings of kinship, encode specific cultural assumptions about family structure, and determine which relationship patterns are easy or difficult to represent. Understanding these structures illuminates how computational approaches both enable and constrain our understanding of human connectedness.</p>
            </div>

            <h3>Core Concepts</h3>
            
            <h4>Representing Human Connections Computationally</h4>
            <p>The fundamental challenge of computational genetic genealogy lies in translating the rich, complex web of human relationships into structured formats that computers can process efficiently. This translation process requires balancing several competing objectives:</p>
            <ul>
                <li>Capturing the essential biological reality of genetic inheritance</li>
                <li>Representing the social dimensions of kinship that may extend beyond genetics</li>
                <li>Organizing information to support efficient computational operations</li>
                <li>Maintaining flexibility to accommodate diverse family structures</li>
                <li>Handling uncertainty and incompleteness in the available data</li>
            </ul>
            
            <p>Bonsai's data structures represent a particular approach to this challenge—one that prioritizes certain aspects of relatedness while necessarily simplifying others. These choices reflect not just technical considerations but deeper conceptual frameworks about what constitutes a family structure and how relationships can be mathematically encoded.</p>

            <h4>The Up-Node Dictionary: From Tree to Forest</h4>
            <p>The central data structure in Bonsai—the "up-node dictionary"—represents a significant conceptual innovation in how we computationally represent family relationships. Unlike traditional family tree representations that focus on a single lineage descending from an ancestor, the up-node dictionary creates a multidirectional network that can represent complex interconnections among multiple lineages.</p>
            
            <p>This structure embodies several key insights about human kinship:</p>
            <ul>
                <li><strong>Multidirectional Perspective</strong>: It acknowledges that kinship flows in multiple directions, with individuals simultaneously positioned as children, parents, siblings, and cousins in different relationships</li>
                <li><strong>Networked Rather Than Hierarchical</strong>: It represents family structures as interconnected webs rather than strict hierarchies, reflecting the reality of complex intermarriage patterns</li>
                <li><strong>Focus on Immediate Connections</strong>: It emphasizes direct parent-child relationships as the building blocks of more complex kinship structures</li>
                <li><strong>Latent Ancestor Representation</strong>: It allows for missing individuals to be inferred and included in the structure, acknowledging the incomplete nature of most genealogical data</li>
            </ul>
            
            <p>This dictionary-based graph representation transforms the traditional concept of a "family tree" into something more like a "family forest"—a collection of interconnected trees that can represent the complex reality of human kinship networks more accurately than strictly hierarchical models.</p>

            <h3>Theoretical Foundations</h3>
            
            <h4>Graph Theory and Kinship Systems</h4>
            <p>The graph-theoretical foundation of Bonsai connects to a long tradition of representing kinship through network structures, from the kinship diagrams used by early anthropologists to modern social network analysis. By representing pedigrees as directed acyclic graphs (DAGs), Bonsai draws on powerful mathematical tools while also making specific assumptions about family structure:</p>
            
            <p><strong>Directed Edges</strong>: The directionality of parent-child relationships encodes the asymmetrical nature of genetic inheritance—genetic material flows from parent to child, not vice versa. This directionality also encodes generational flow and temporal ordering.</p>
            
            <p><strong>Acyclicity Constraint</strong>: The prohibition of cycles in the graph enforces a fundamental biological reality—no individual can be their own ancestor. This constraint embodies a linear conception of time and generational progression that is central to many cultural understandings of kinship.</p>
            
            <p><strong>Biparental Structure</strong>: The limitation of two parents per individual reflects the biological reality of sexual reproduction in humans while also encoding a particular cultural model of family structure that may not fully represent the diversity of kinship systems worldwide.</p>
            
            <p><strong>Node Attributes</strong>: The ability to attach additional information (like sex, age, or genetic data) to individual nodes allows the graph to integrate biological, demographic, and social dimensions of identity relevant to kinship analysis.</p>
            
            <p>These graph-theoretical properties create a flexible framework for representing family structures, but they also embed particular cultural assumptions that shape how relationships can be conceptualized and analyzed.</p>

            <h4>Information Organization and Epistemic Hierarchies</h4>
            <p>The way Bonsai organizes and indexes information about genetic relationships creates an implicit epistemic hierarchy—prioritizing certain types of knowledge and making them more accessible while relegating others to secondary status:</p>
            
            <p><strong>Pairwise Organization</strong>: By indexing IBD segments primarily by pairs of individuals, Bonsai privileges dyadic relationships as the basic unit of analysis. This approach aligns with Western genealogical traditions that emphasize direct lineal connections but may de-emphasize the extended kinship networks emphasized in other cultural traditions.</p>
            
            <p><strong>Statistical Moments</strong>: The reduction of complex IBD sharing patterns to statistical moments (counts and lengths) prioritizes quantitative summaries over qualitative features. This statistical approach enables computational efficiency but may obscure the specific inheritance patterns that could be culturally or historically significant.</p>
            
            <p><strong>Generation-Based Structure</strong>: The up-node dictionary's parent-child focus creates a generation-centric organization of kinship information. This aligns with descent-based understandings of kinship but may obscure lateral relationships (like cousins or siblings) that are central to many cultural kinship systems.</p>
            
            <p><strong>Individual as Primary Unit</strong>: By organizing data around individual identities, Bonsai embeds a particular perspective on kinship that centers individual identities rather than collective relationships. This reflects modern Western conceptions of personhood but may differ from cultural traditions that emphasize group membership or contextual identity.</p>
            
            <p>These organizational choices reflect both technical requirements and cultural assumptions about how kinship information should be structured, accessed, and prioritized.</p>

            <h3>Applications and Implications</h3>
            
            <h4>Computational Efficiency and Cultural Bias</h4>
            <p>The technical optimizations in Bonsai's data structures have profound implications for whose family structures can be efficiently represented and analyzed:</p>
            
            <p><strong>Sparse Representation</strong>: The efficient storage of relationships using sparse dictionaries works well for family structures with clearly defined, relatively distant relationships—typical of post-industrial Western societies with nuclear family units and limited consanguinity. However, this representation becomes less efficient for highly endogamous populations with extensive intermarriage and complex relationship networks.</p>
            
            <p><strong>Caching Strategies</strong>: The memoization of relationship coefficients optimizes for repeated queries about the same relationships. This approach privileges analysis patterns common in Western genealogical research (exploring specific lineages) but may be less efficient for analyses that examine broader community structures or collective kinship patterns.</p>
            
            <p><strong>Community Detection</strong>: The graph partitioning approach based on IBD sharing implicitly assumes that genetic communities align with social or cultural communities. This may accurately reflect some populations but can misrepresent communities where kinship includes significant non-biological relationships or where cultural boundaries cut across genetic similarities.</p>
            
            <p><strong>Priority-Based Processing</strong>: Prioritizing relationships with higher IBD sharing embodies a particular hierarchy of genealogical knowledge—privileging close, clearly defined relationships over distant or complex ones. This approach may efficiently identify immediate family but can marginalize the detection of more distant or complex relationship patterns that might be culturally significant in some contexts.</p>
            
            <p>These technical choices reveal how seemingly neutral optimization strategies can embed cultural assumptions and potentially perpetuate biases in whose family structures are most efficiently represented and analyzed.</p>

            <h4>Visualizing Kinship: From Data Structure to Human Understanding</h4>
            <p>Translating Bonsai's computational representations back into forms humans can intuitively understand involves important conceptual transformations:</p>
            
            <p><strong>Traditional Pedigree Diagrams</strong>: Converting Bonsai's graph structure into conventional family trees requires imposing a specific hierarchical perspective that may privilege certain lineages over others. This translation process often embeds cultural assumptions about which relationships matter most.</p>
            
            <p><strong>Temporal Representation</strong>: Visualizing generational depth and timing involves interpreting the abstract graph structure through cultural frameworks of time and progression. Different cultural traditions might organize this temporal dimension differently—emphasizing cyclical patterns, ancestral connections, or future projections.</p>
            
            <p><strong>Relationship Terminology</strong>: Labeling relationships in visualizations requires mapping computational relationships to culturally specific kinship terms. The same graph structure might be described using different terminology in different cultural contexts—what Bonsai might compute as a "second cousin once removed" could be understood as simply "cousin" or with a completely different term in another cultural system.</p>
            
            <p><strong>Uncertainty Visualization</strong>: Representing inferred relationships or uncertain connections involves translating computational probabilities into visual cues that humans can intuitively understand. This translation must balance technical accuracy with cultural interpretability.</p>
            
            <p>The movement between computational representation and human understanding highlights the interpretive nature of kinship knowledge—Bonsai doesn't simply discover objective relationships but participates in constructing particular understandings of connection that must be interpreted within specific cultural frameworks.</p>

            <h3>Broader Context</h3>
            
            <h4>Diverse Kinship Systems and Computational Representation</h4>
            <p>Bonsai's data structures embody a particular model of kinship that may not fully represent the diversity of human relationship systems across cultures:</p>
            
            <p><strong>Bilateral Descent Systems</strong>: The up-node dictionary with its biparental structure aligns well with bilateral descent systems (common in Western societies) that trace ancestry through both maternal and paternal lines. However, it may less naturally represent:</p>
            <ul>
                <li><strong>Unilineal Systems</strong>: Societies with matrilineal or patrilineal descent, where only one parental line is considered for determining kinship</li>
                <li><strong>Cognatic Systems</strong>: Cultures where individuals can choose which lineage to affiliate with</li>
                <li><strong>Non-Genealogical Kinship</strong>: Systems where significant kinship is established through means other than biological descent (adoption, marriage alliances, spiritual relationships)</li>
            </ul>
            
            <p><strong>Marriage Structures</strong>: The basic parent-child representation can be extended to incorporate different marriage patterns, but with varying computational efficiency:</p>
            <ul>
                <li><strong>Monogamy</strong>: Efficiently represented by the standard structure</li>
                <li><strong>Polygyny/Polyandry</strong>: Representable through multiple parent-child connections but requiring additional interpretation</li>
                <li><strong>Complex Marriage Systems</strong>: Systems like the classificatory kinship of some Aboriginal Australian societies or the "ghost marriage" practices in some African cultures may require significant adaptations to the basic data structure</li>
            </ul>
            
            <p><strong>Cultural Kinship Concepts</strong>: Many cultural concepts of relatedness extend beyond the biological relationships that form Bonsai's primary focus:</p>
            <ul>
                <li><strong>Fictive Kinship</strong>: Kinship-like bonds between unrelated individuals</li>
                <li><strong>Clan and Moiety Systems</strong>: Group-based kinship that may cross-cut biological relationships</li>
                <li><strong>Spiritual Kinship</strong>: Relationships formed through religious ceremonies (like godparenthood)</li>
            </ul>
            
            <p>These diverse systems highlight both the flexibility and limitations of Bonsai's computational approach to representing human relationships.</p>

            <h4>Ethical Dimensions of Relationship Representation</h4>
            <p>The data structures used to represent family relationships raise important ethical considerations:</p>
            
            <p><strong>Privacy and Interconnectedness</strong>: The networked nature of pedigree structures means that including one individual necessarily reveals information about their relatives. This interconnectedness creates complex privacy challenges where individual consent may not sufficiently protect family information.</p>
            
            <p><strong>Representation of Uncertainty</strong>: How probabilistic relationship inferences are stored and communicated has profound implications for individuals whose family connections may be questioned or revised by computational analysis. Data structures that foreground uncertainty can either create helpful nuance or potentially destabilizing ambiguity.</p>
            
            <p><strong>Cultural Appropriateness</strong>: The assumptions embedded in data structures about what constitutes family may conflict with cultural understandings of kinship and identity. This mismatch can potentially harm communities whose relationship systems are not well represented by the computational model.</p>
            
            <p><strong>Historical Trauma</strong>: For communities with histories of family disruption (through slavery, forced adoption, genocide, etc.), the computational reconstruction of family structures intersects with deep historical wounds. Data structures that can respectfully represent these disrupted histories require careful design.</p>
            
            <p><strong>Accessibility and Control</strong>: The technical complexity of advanced data structures can create barriers to understanding and controlling one's own family information. This raises questions about who has the expertise to interpret and potentially challenge computational representations of kinship.</p>
            
            <p>These ethical dimensions highlight the need for thoughtful, culturally sensitive approaches to the design and application of computational kinship representations.</p>

            <div class="exercises-section">
                <h3>Exercises</h3>
            <ol>
                <li>Implement an efficient IBD segment indexing structure for v3 that handles both phased and unphased genetic data with benchmarking capabilities</li>
                <li>Extend the up-node dictionary implementation to handle additional relationship metadata for v3, including support for relationship types, confidence scores, and temporal information</li>
                <li>Implement and test a cycle detection algorithm for pedigree validation with comprehensive biological consistency checks</li>
                <li>Create a visualization function that renders a pedigree from an up-node dictionary, highlighting different generations and relationship types</li>
                <li>Implement a memory-efficient version of the relationship coefficient calculator using sparse matrix representations for large pedigrees</li>
            </ol>
            <p>All five exercises are provided with full implementations in the Jupyter notebook, demonstrating practical extensions to the Bonsai v3 algorithm.</p>
            </div>

            <div class="alert alert-success">
                <p><strong>Tip:</strong> When working with computational representations of human relationships, remember that these structures are not neutral technical implementations but embody specific cultural assumptions about family and connection. Regularly questioning these assumptions and considering alternative frameworks can help develop more inclusive and culturally sensitive approaches to representing the diverse ways humans understand their kinship connections.</p>
            </div>
            
            <h3>Interactive Lab Environment</h3>
            
            <div class="jupyter-integration">
                <p>In this lab, you'll explore the data structures used in Bonsai v3 to represent complex family relationships and organize genetic sharing information, with enhanced features for handling both phased and unphased genetic data.</p>
                
                <div class="jupyterlite-container">
                    
                    <div class="jupyterlite-info">
                        <h4>Browser-Based Analysis</h4>
                        <p>The notebook demonstrates how Bonsai v3 encodes relationship information in efficient data structures, from the up-node dictionary to specialized graph representations. You'll work with the latest version of the Bonsai algorithm which includes enhanced features for both phased and unphased genetic data.</p>
                        <ol>
                            <li>Click the "Open Lab 14 Notebook in JupyterLite" button below</li>
                            <li>In the file browser that appears, click on "<strong>Lab14_Bonsai_Data_Structures_v3.ipynb</strong>" to open this lab's notebook</li>
                            <li>You can now run the code cells by clicking on them and pressing Shift+Enter</li>
                        </ol>
                        <p>Your progress is automatically saved in your browser's storage.</p>
                    </div>
                    
                    <a href="https://lakishadavid.github.io/computational_genetic_genealogy/jupyterlite_app/lab/index.html?path=Lab14_Bonsai_Data_Structures_v3.ipynb"
                       class="open-jupyterlite-link"
                       target="_blank"
                       role="button">
                        Open Lab 14 Notebook in JupyterLite
                    </a>
                </div>
                
                <div class="alert alert-info">
                    <p><strong>Note:</strong> This updated lab uses the latest Bonsai v3 implementation with improved data structures and algorithms. The interactive notebook automatically loads data from previous labs if you completed them. Your work is saved in your browser's storage between lab sessions.</p>
                </div>
            </div>

            <h3>Beyond the Code</h3>
            <p>The data structures used to represent family relationships connect to broader approaches to organizing information:</p>
            <ul>
                <li><strong>Representation Choices:</strong> How the structures we use to organize information shape what we can recognize and understand</li>
                <li><strong>Information Hierarchies:</strong> How different organizational approaches privilege certain perspectives</li>
                <li><strong>Computational Efficiency:</strong> The balance between representational accuracy and processing requirements</li>
                <li><strong>Cultural Encoding:</strong> How data structures reflect cultural understandings of relationships</li>
            </ul>
            <p>These considerations highlight how the technical choices in data representation are never neutral but always embed particular perspectives on what matters in human relationships.</p>
            
            <h3>From Lab to Production: Understanding the Real Bonsai v3 Implementation</h3>
            
            <p>This lab's notebook has been updated to align with the latest Bonsai v3 implementation, but the production code includes additional optimizations and features for handling real-world scenarios. Let's explore how our lab code connects to the actual Bonsai v3 implementation.</p>
            
            <h4>The Up-Node Dictionary</h4>
            
            <p>The up-node dictionary in our lab (Cell 12) closely resembles the v3 implementation's core structure:</p>
            
            <pre><code># Lab implementation (v3-aligned)
up_node_dict = {
    1000: {1001: 1, 1002: 1},  # Individual 1000 has parents 1001 and 1002
    1003: {1001: 1, 1002: 1},  # Individual 1003 has the same parents
    1004: {-1: 1, -2: 1},      # Individual 1004 has inferred parents -1 and -2
    -1: {1005: 1, 1006: 1},    # Inferred individual -1 has parents 1005 and 1006
}</code></pre>
            
            <p>The production v3 code extends this concept with several key enhancements:</p>
            <ul>
                <li><strong>Systematic ID management</strong>: The v3 code includes sophisticated ID tracking systems to ensure inferred ancestors receive unique negative IDs that don't conflict when pedigrees are merged</li>
                <li><strong>Extended relation attributes</strong>: Similar to our Exercise 2 solution, the production code can store additional metadata about each relationship</li>
                <li><strong>Optimized traversal algorithms</strong>: The production v3 code implements highly optimized breadth-first and depth-first traversal algorithms, similar to our cycle detection implementation in Exercise 3</li>
            </ul>
            
            <h4>The PwLogLike Class</h4>
            
            <p>Our lab's implementation of the PwLogLike class (Cell 19) closely mirrors the v3 implementation, with the same core functionality for calculating pairwise log likelihoods:</p>
            
            <pre><code># Lab v3 implementation
class PwLogLike:
    """Class for computing pairwise likelihoods between individuals."""
    
    def __init__(self, bio_info, unphased_ibd_seg_list, condition_pair_set=None,
                 mean_bgd_num=MEAN_BGD_NUM, mean_bgd_len=MEAN_BGD_LEN):
        """Initialize with biological info and IBD segments."""
        self.bio_info = bio_info
        self.id_to_info = {info['genotype_id']: info for info in bio_info}
        self.ibd_stat_dict = get_ibd_stats_unphased(unphased_ibd_seg_list)
        self.condition_pair_set = condition_pair_set or set()
        self.mean_bgd_num = mean_bgd_num
        self.mean_bgd_len = mean_bgd_len</code></pre>
            
            <p>The production v3 class includes these additional features:</p>
            <ul>
                <li><strong>Improved statistical models</strong>: More sophisticated likelihood calculations based on extensive empirical validation</li>
                <li><strong>Additional conditioning options</strong>: Support for conditional and unconditional likelihood calculations with more options</li>
                <li><strong>Performance optimizations</strong>: Strategic caching and memoization strategies similar to our Exercise 5 solution</li>
            </ul>
            
            <h4>Phased and Unphased IBD Data</h4>
            
            <p>Our lab implementation now includes v3's support for both phased and unphased IBD segments (Cell 7), with the ability to convert between formats:</p>
            
            <pre><code># Lab v3 implementation for phased/unphased conversion
def get_unphased_to_phased(unphased_ibd_seg_list):
    """
    Convert unphased IBD segments to phased IBD segments.
    
    Args:
        unphased_ibd_seg_list: List of the form 
            [[id1, id2, chromosome, start_bp, end_bp, is_full_ibd, seg_len_cm],...]
            
    Returns:
        phased_ibd_seg_list: List of the form 
            [[id1, id2, hap1, hap2, chromosome, start_cm, end_cm, cm],...]
    """</code></pre>
            
            <p>This dual-format support enables Bonsai v3 to:</p>
            <ul>
                <li>Work with diverse IBD detection algorithms that produce either phased or unphased output</li>
                <li>Leverage phase information when available for more precise relationship inference</li>
                <li>Handle mixed datasets where some segments have phase information and others don't</li>
                <li>Maintain backward compatibility with tools and datasets from previous versions</li>
            </ul>
            
            <h4>Connection Point Finding in v3</h4>
            
            <p>Our lab now implements v3's more modular approach to finding connection points between pedigrees (Cell 21):</p>
            
            <pre><code># v3 connection point implementation
def get_connecting_points_degs_and_log_likes(
    up_dct1, 
    up_dct2, 
    pw_ll_cls,
    ibd_seg_list,
    condition=False, 
    min_seg_len=MIN_SEG_LEN,
    max_con_pts=MAX_CON_PTS, 
    restrict_connection_points=RESTRICT_CON_PTS,
    connect_up_only=CONNECT_UP_ONLY,
):
    """Find potential connection points between two pedigrees."""</code></pre>
            
            <p>The production v3 code extends this with:</p>
            <ul>
                <li><strong>Optimized search strategies</strong>: More efficient algorithms for finding the best connection points</li>
                <li><strong>Constraint propagation</strong>: Advanced techniques to reduce the search space based on biological constraints</li>
                <li><strong>Pedigree transformation</strong>: Sophisticated methods to restructure pedigrees for optimal connection</li>
            </ul>
            
            <h4>Advanced Data Structures</h4>
            
            <p>Our lab explores several advanced data structures through the exercises that reflect modern Bonsai v3 capabilities:</p>
            
            <ol>
                <li><strong>Exercise 1: IBD Indexing</strong>: Our IBDIndex class mirrors v3's efficient segment indexing structure with support for phased and unphased data</li>
                <li><strong>Exercise 2: Extended Up-Node Dictionary</strong>: Our implementation with relationship metadata reflects v3's enhanced relationship representation</li>
                <li><strong>Exercise 3: Pedigree Validation</strong>: The PedigreeValidator class implements v3-style consistency checking</li>
                <li><strong>Exercise 4: Visualization</strong>: Our visualizer with support for different relationship types mirrors v3's visualization capabilities</li>
                <li><strong>Exercise 5: Sparse Matrix Representation</strong>: Our sparse relationship calculator reflects v3's memory-efficient computation strategies</li>
            </ol>
            
            <p>These exercise implementations provide a comprehensive understanding of the data structures and algorithms that power Bonsai v3's ability to reconstruct pedigrees from genetic data.</p>
            
            <div class="learning-pathway">
                <p>This lab is part of the Bonsai specialization track:</p>
                <div class="pathway-steps">
                    <div class="pathway-step">
                        <h5>Introduction</h5>
                        <p>Lab 11</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Fundamentals</h5>
                        <p>Lab 12</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Mathematics</h5>
                        <p>Lab 13</p>
                    </div>
                    <div class="pathway-step active">
                        <h5>Data Structures</h5>
                        <p>Lab 14</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Calibration</h5>
                        <p>Lab 15</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Architecture</h5>
                        <p>Lab 16</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Likelihood</h5>
                        <p>Lab 17</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Quality</h5>
                        <p>Lab 18</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Advanced</h5>
                        <p>Lab 19</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Visualization</h5>
                        <p>Lab 20</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Applications</h5>
                        <p>Lab 21</p>
                    </div>
                </div>
            </div>
            

            <div class="lab-navigation">
                <a href="lab13_bonsai_mathematical.html" class="prev-lab">Mathematical Foundations</a>
                <a href="lab15_bonsai_calibration.html" class="next-lab">Model Calibration</a>
            </div>
        </article>
    </main>

    <footer class="textbook-footer">
        <div class="container">
            <p>&copy; 2025 Dr. LaKisha David, Department of Anthropology, University of Illinois Urbana-Champaign</p>
        </div>
    </footer>
</body>
</html>
