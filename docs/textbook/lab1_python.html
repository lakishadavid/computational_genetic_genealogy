<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 1: Python Basics | Computational Genetic Genealogy</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <header>
        <h1>Computational Genetic Genealogy</h1>
        <p>Python Basics for Genetic Analysis</p>
    </header>

    <nav class="main-nav">
        <a href="../index.html">Home</a>
        <a href="contents.html">Contents</a>
        <a href="lab1_python.html" class="active">Lab 1: Python Basics</a>
    </nav>

    <main class="container">
        <article class="section lab-content">
            <h2>Lab 1: Python Basics for Genetic Analysis</h2>
            
            <div class="alert alert-info">
                <p><strong>Why This Matters:</strong> Python is the primary programming language for bioinformatics and genetic data analysis. Understanding key Python concepts will allow you to process genetic data, implement algorithms, and create visualizations throughout this course.</p>
            </div>

            <h3>Learning Objectives</h3>
            <ul class="objectives-list">
                <li>Understand basic Python data structures relevant to genetic data</li>
                <li>Learn to read and write files with Python</li>
                <li>Use key libraries for scientific computing (NumPy, Pandas)</li>
                <li>Create basic visualizations with Matplotlib and Seaborn</li>
                <li>Implement simple genetic data processing workflows</li>
            </ul>

            <h3>Key Concepts</h3>
            
            <h4>Python Data Structures for Genetic Data</h4>
            <p>Different genetic data elements map naturally to different Python data structures:</p>
            
            <table>
                <tr>
                    <th>Genetic Data</th>
                    <th>Python Data Structure</th>
                    <th>Example</th>
                </tr>
                <tr>
                    <td>DNA sequence</td>
                    <td>String</td>
                    <td><code>"ATGCTAGCTAGCTA"</code></td>
                </tr>
                <tr>
                    <td>Genetic markers</td>
                    <td>Dictionary</td>
                    <td><code>{"rs123": "AA", "rs456": "CT"}</code></td>
                </tr>
                <tr>
                    <td>IBD segments</td>
                    <td>Pandas DataFrame</td>
                    <td>Table with columns for segments</td>
                </tr>
                <tr>
                    <td>Sample collection</td>
                    <td>List or Set</td>
                    <td><code>["sample1", "sample2", "sample3"]</code></td>
                </tr>
            </table>

            <h4>Basic Python Operations</h4>
            <p>Here are some foundational Python operations we'll use frequently:</p>
            
            <pre><code># Variable assignment
dna_sequence = "ATGCTAGCTAGCTA"

# Conditional logic
if "ATG" in dna_sequence:
    print("Start codon found!")

# Loops
for base in dna_sequence:
    if base == "A":
        a_count += 1
        
# Functions
def count_base(sequence, base):
    """Count occurrences of a nucleotide base in a DNA sequence."""
    return sequence.count(base)

# Dictionaries for key-value data
genotype = {"rs123": "AA", "rs456": "CT", "rs789": "GG"}
if genotype["rs123"] == "AA":
    print("Homozygous A at rs123")</code></pre>

            <h4>Scientific Python Libraries</h4>
            <p>For genetic analysis, we rely on several key libraries:</p>
            
            <table>
                <tr>
                    <th>Library</th>
                    <th>Purpose</th>
                    <th>Common Uses</th>
                </tr>
                <tr>
                    <td>NumPy</td>
                    <td>Numerical computing</td>
                    <td>Arrays, mathematical operations, random sampling</td>
                </tr>
                <tr>
                    <td>Pandas</td>
                    <td>Data manipulation</td>
                    <td>Reading/writing files, data filtering, analysis</td>
                </tr>
                <tr>
                    <td>Matplotlib</td>
                    <td>Basic visualization</td>
                    <td>Plots, histograms, scatter plots</td>
                </tr>
                <tr>
                    <td>Seaborn</td>
                    <td>Statistical visualization</td>
                    <td>Heatmaps, distribution plots, categorical plots</td>
                </tr>
            </table>

            <h3>Working with Genetic Data Files</h3>
            
            <h4>Reading and Writing Files</h4>
            <p>Python makes it easy to work with various file formats:</p>
            
            <pre><code># Reading a text file (e.g., simple DNA sequence)  
with open("dna_sequence.txt", "r") as file:
    sequence = file.read().strip()

# Reading a CSV file (e.g., genotype data)
import pandas as pd
genotype_data = pd.read_csv("genotypes.csv")

# Reading a VCF file (specialized format for genetic variants)
import allel
vcf = allel.read_vcf("samples.vcf.gz")

# Writing output to a file
with open("results.txt", "w") as file:
    file.write(f"Total A bases: {count_base(sequence, 'A')}\n")
    file.write(f"Total G bases: {count_base(sequence, 'G')}\n")</code></pre>

            <h4>Processing Genetic Data with Pandas</h4>
            <p>Pandas is particularly useful for manipulating tabular genetic data:</p>
            
            <pre><code>import pandas as pd

# Read a genetic data file
ibd_segments = pd.read_csv("ibd_segments.csv")

# Basic data exploration
print(f"Total segments: {len(ibd_segments)}")
print(ibd_segments.head())  # View first few rows
print(ibd_segments.describe())  # Basic statistics

# Filtering data
long_segments = ibd_segments[ibd_segments["segment_length"] > 7.0]
chromosome_1 = ibd_segments[ibd_segments["chromosome"] == 1]

# Grouping and aggregating
segments_by_chromosome = ibd_segments.groupby("chromosome").agg({
    "segment_length": ["mean", "std", "count"],
    "start_position": "min",
    "end_position": "max"
})

# Sorting
ibd_segments.sort_values(by="segment_length", ascending=False).head(10)</code></pre>

            <h3>Visualizing Genetic Data</h3>
            
            <h4>Basic Plots with Matplotlib</h4>
            <p>Matplotlib helps us visualize genetic data patterns:</p>
            
            <pre><code>import matplotlib.pyplot as plt
import numpy as np

# Histogram of IBD segment lengths
plt.figure(figsize=(10, 6))
plt.hist(ibd_segments["segment_length"], bins=30, alpha=0.7)
plt.title("Distribution of IBD Segment Lengths")
plt.xlabel("Segment Length (cM)")
plt.ylabel("Frequency")
plt.grid(True, alpha=0.3)
plt.savefig("segment_length_distribution.png", dpi=300)

# Scatter plot of segments by chromosome
plt.figure(figsize=(12, 6))
plt.scatter(
    ibd_segments["chromosome"],
    ibd_segments["segment_length"],
    alpha=0.5, s=5
)
plt.title("IBD Segments by Chromosome")
plt.xlabel("Chromosome")
plt.ylabel("Segment Length (cM)")
plt.xticks(range(1, 23))
plt.savefig("segments_by_chromosome.png", dpi=300)</code></pre>

            <h4>Statistical Visualizations with Seaborn</h4>
            <p>Seaborn enhances matplotlib with statistical visualizations:</p>
            
            <pre><code>import seaborn as sns

# Set aesthetic style
sns.set(style="whitegrid")

# Box plot of segment lengths by chromosome
plt.figure(figsize=(14, 6))
sns.boxplot(x="chromosome", y="segment_length", data=ibd_segments)
plt.title("IBD Segment Length Distribution by Chromosome")
plt.xlabel("Chromosome")
plt.ylabel("Segment Length (cM)")
plt.savefig("boxplot_by_chromosome.png", dpi=300)

# Heatmap of segment count by chromosome and sample pair
segment_counts = pd.crosstab(
    [ibd_segments["sample1"], ibd_segments["sample2"]],
    ibd_segments["chromosome"]
)

plt.figure(figsize=(12, 10))
sns.heatmap(segment_counts, cmap="viridis", cbar_kws={"label": "Segment Count"})
plt.title("IBD Segments Between Sample Pairs by Chromosome")
plt.xlabel("Chromosome")
plt.ylabel("Sample Pairs")
plt.savefig("segment_heatmap.png", dpi=300)</code></pre>

            <h3>A Simple Genetic Data Processing Pipeline</h3>
            <p>Let's put it all together in a simple workflow:</p>
            
            <pre><code>import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

def analyze_genetic_relatedness(segment_file, output_dir):
    """Analyze genetic relatedness from IBD segment data."""
    # Create output directory if it doesn't exist
    import os
    os.makedirs(output_dir, exist_ok=True)
    
    # Load the data
    segments = pd.read_csv(segment_file)
    print(f"Loaded {len(segments)} segments from {len(segments['sample1'].unique())} individuals")
    
    # Calculate total IBD sharing between each pair
    pair_sharing = segments.groupby(["sample1", "sample2"]).agg({
        "segment_length": ["sum", "count"],
        "chromosome": "nunique"
    })
    pair_sharing.columns = ["total_length", "segment_count", "chromosomes_shared"]
    pair_sharing = pair_sharing.sort_values("total_length", ascending=False).reset_index()
    
    # Save summary to file
    pair_sharing.to_csv(f"{output_dir}/pair_sharing_summary.csv", index=False)
    
    # Generate visualizations
    # 1. Histogram of segment lengths
    plt.figure(figsize=(10, 6))
    sns.histplot(segments["segment_length"], bins=30, kde=True)
    plt.title("Distribution of IBD Segment Lengths")
    plt.xlabel("Segment Length (cM)")
    plt.ylabel("Frequency")
    plt.savefig(f"{output_dir}/segment_length_histogram.png", dpi=300)
    
    # 2. Scatter plot of total sharing vs. segment count
    plt.figure(figsize=(10, 6))
    sns.scatterplot(
        x="total_length", 
        y="segment_count", 
        size="chromosomes_shared",
        sizes=(20, 200),
        alpha=0.7,
        data=pair_sharing
    )
    plt.title("Total IBD Sharing Between Sample Pairs")
    plt.xlabel("Total IBD Length (cM)")
    plt.ylabel("Number of IBD Segments")
    plt.savefig(f"{output_dir}/total_sharing_scatter.png", dpi=300)
    
    return pair_sharing

# Usage example
pair_sharing = analyze_genetic_relatedness(
    "data/ibd_segments.csv", 
    "results/relatedness_analysis"
)</code></pre>

            <h3>Anthropological Context</h3>
            <p>Python's ability to process and visualize genetic data is crucial for anthropological research because:</p>
            
            <ul>
                <li><strong>Data Integration:</strong> Python allows anthropologists to combine genetic data with cultural, historical, and geographical information</li>
                <li><strong>Pattern Recognition:</strong> Visualizations help identify patterns of genetic relatedness that might reflect historical events or cultural practices</li>
                <li><strong>Hypothesis Testing:</strong> Statistical analyses can test hypotheses about population movements and family reconstruction</li>
                <li><strong>Reproducible Research:</strong> Python scripts document the exact analytical process, making anthropological findings transparent and reproducible</li>
            </ul>
            
            <p>For anthropologists studying genetic genealogy, Python provides the tools to bridge biological data and sociocultural understanding by transforming raw genetic information into meaningful insights about human relationships and history.</p>

            <h3>Exercises</h3>
            <ol>
                <li>Create a function to calculate basic statistics about a genetic dataset (count, mean, etc.)</li>
                <li>Write a script to filter IBD segments by length and chromosome</li>
                <li>Generate a visualization showing the distribution of IBD segments across chromosomes</li>
                <li>Create a heatmap showing genetic relatedness between sample pairs</li>
                <li>Implement a simple pipeline to process a raw genetic data file, perform basic analysis, and save results</li>
            </ol>

            <div class="alert alert-success">
                <p><strong>Tip:</strong> When working with large genetic datasets, use Pandas' methods like <code>.head()</code>, <code>.sample()</code>, and <code>.info()</code> to explore the data structure before processing the entire dataset.</p>
            </div>
            
            <div class="lab-navigation">
                <a href="lab0_data.html" class="prev-lab">Getting Data</a>
                <a href="lab2_exploring.html" class="next-lab">Exploring Data</a>
            </div>
        </article>
    </main>

    <footer>
        <p>&copy; 2025 Dr. LaKisha David, Department of Anthropology, University of Illinois Urbana-Champaign</p>
    </footer>
</body>
</html>