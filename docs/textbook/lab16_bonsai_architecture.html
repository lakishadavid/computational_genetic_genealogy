<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 16: Bonsai Architecture | Computational Genetic Genealogy</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body class="textbook-page">
    <header class="textbook-header">
        <div class="container">
            <h1>Computational Genetic Genealogy</h1>
            <p>Architecture and Implementation of Bonsai</p>
        </div>
    </header>

    <nav class="textbook-nav">
        <div class="container">
            <a href="../index.html"><i class="fas fa-arrow-left"></i> Back to Main Page</a>
            <a href="contents.html">Table of Contents</a>
            <a href="lab16_bonsai_architecture.html" class="active">Lab 16 bonsai architecture</a>
        </div>
    </nav>

    <main class="container">
        <article class="section lab-content">
            <h2>Lab 16: Architecture and Implementation of Bonsai</h2>
            
            <div class="alert alert-info">
                <p><strong>Why This Matters:</strong> The design choices in computational tools like Bonsai represent more than technical decisions—they encode specific values, priorities, and conceptual frameworks. By understanding how Bonsai's architecture embodies certain approaches to knowledge organization, collaborative work, and problem-solving, we gain insight into the relationship between technological structures and the human stories they help us construct.</p>
            </div>

            <h3>Core Concepts</h3>
            
            <h4>Architecture as Epistemology</h4>
            <p>Software architecture is not merely a technical blueprint but an embodiment of epistemological frameworks—how we organize, validate, and create knowledge. Bonsai's architecture reflects a particular approach to understanding human relationships through genetic data, with significant implications for how we conceptualize kinship and ancestry.</p>
            
            <p>The architectural choices in Bonsai reveal several underlying epistemological commitments:</p>
            <ul>
                <li><strong>Modularity as Knowledge Organization</strong>: By separating concerns into discrete components (data handling, relationship modeling, optimization), Bonsai embodies a modular understanding of knowledge that allows different aspects of genetic relationships to be analyzed independently while maintaining their interconnections</li>
                <li><strong>Probabilistic Reasoning</strong>: The centrality of likelihood functions and statistical models reflects a commitment to understanding relationships as probabilistic rather than deterministic, acknowledging inherent uncertainty in genetic inference</li>
                <li><strong>Hierarchical Organization</strong>: The layered architecture, with lower levels handling data and higher levels managing abstract relationship concepts, encodes a hierarchical view of knowledge from raw data to interpreted relationships</li>
                <li><strong>Iterative Refinement</strong>: The optimization approaches embody an understanding of knowledge as something developed through successive approximation rather than immediate revelation</li>
            </ul>
            
            <p>These architectural principles reflect broader scientific values about how we should organize and validate knowledge about human relationships. They privilege certain approaches to understanding (statistical, iterative, modular) while potentially marginalizing others (holistic, intuitive, narrative-based).</p>

            <h4>The Social Life of Software Architecture</h4>
            <p>Software architectures are inherently social constructs, shaped by and shaping the communities that develop and use them. Bonsai's architecture embodies particular social values and collaborative structures:</p>
            
            <p><strong>Collaborative Development Patterns</strong>: The modular architecture facilitates specific forms of collaboration, where different specialists can work on separate components with minimal coordination. This reflects academic and open-source collaborative models where expertise is distributed across individuals and institutions.</p>
            
            <p><strong>Community Access and Participation</strong>: The design of APIs, configuration systems, and extension points determines who can meaningfully participate in developing and customizing the tool. More complex architectures with steep learning curves may privilege certain types of expertise and implicitly exclude others.</p>
            
            <p><strong>Knowledge Transfer Paradigms</strong>: The documentation structures, code organization, and variable naming conventions embody specific approaches to how knowledge about the system is transmitted between developers, users, and across time as the project evolves.</p>
            
            <p><strong>Trust and Validation Mechanisms</strong>: The architecture incorporates specific mechanisms for ensuring reliability and validity—automated tests, validation checks, error handling—that reflect particular social understandings of trust, expertise, and authority in knowledge production.</p>
            
            <p>These social dimensions of architecture highlight that technical decisions are always embedded in human relationships, power structures, and community dynamics. The architecture doesn't just process data; it organizes human collaboration and knowledge transfer.</p>

            <h3>Theoretical Foundations</h3>
            
            <h4>The Modular Architecture of Knowledge</h4>
            <p>Bonsai's modular architecture represents a specific approach to organizing complex knowledge systems—one with theoretical roots in both computer science and epistemology:</p>
            
            <p>The core components of Bonsai's architecture include:</p>
            <ul>
                <li><strong>Input Handling</strong>: Components for processing and validating raw genetic data</li>
                <li><strong>Relationship Modeling</strong>: Statistical models describing expected genetic patterns for different relationship types</li>
                <li><strong>Pedigree Representation</strong>: Data structures for encoding and manipulating family structures</li>
                <li><strong>Optimization Engine</strong>: Algorithms for searching the space of possible pedigrees</li>
                <li><strong>Constraint System</strong>: Mechanisms for enforcing biological and logical constraints</li>
                <li><strong>Output Generation</strong>: Tools for communicating results in different formats</li>
            </ul>
            
            <p>This modularity embodies several theoretical principles with broader implications:</p>
            <ul>
                <li><strong>Separation of Concerns</strong>: The division between different aspects of the problem (data handling, relationship modeling, optimization) reflects a belief that complex problems are best understood by decomposing them into simpler sub-problems</li>
                <li><strong>Information Hiding</strong>: The encapsulation of implementation details within modules allows users to engage with concepts at an appropriate level of abstraction, without needing to understand all underlying complexities</li>
                <li><strong>Interface-Based Design</strong>: Components interact through well-defined interfaces rather than direct knowledge of internal workings, creating a form of knowledge organization that privileges clarity of boundaries</li>
            </ul>
            
            <p>These principles have parallels in how we organize scientific knowledge more broadly—through disciplinary boundaries, levels of theoretical abstraction, and standardized methods of communication between fields. The architecture is thus not just a technical convenience but a reflection of deeper ideas about how knowledge should be structured.</p>

            <h4>The Algorithmic Expression of Values</h4>
            <p>Bonsai's core algorithms encode specific values and priorities about what matters in genetic relationship inference:</p>
            
            <p><strong>Search Algorithms and Optimization Approaches</strong>: The choice of algorithms for searching the space of possible pedigrees—whether greedy search, simulated annealing, or MCMC sampling—embodies specific trade-offs between:</p>
            <ul>
                <li>Thoroughness versus efficiency (how comprehensive should the search be?)</li>
                <li>Determinism versus randomness (should the same inputs always produce the same results?)</li>
                <li>Exploitation versus exploration (how much should we pursue promising leads versus exploring alternatives?)</li>
            </ul>
            
            <p>These algorithmic choices reflect values about what constitutes "good enough" knowledge and how we should balance competing priorities in its pursuit.</p>
            
            <p><strong>Constraint Handling</strong>: How Bonsai implements and enforces biological and logical constraints reveals assumptions about:</p>
            <ul>
                <li>The rigidity of biological rules (which constraints are "hard" versus "soft")</li>
                <li>How to weigh biological plausibility against observed genetic evidence</li>
                <li>Which biological assumptions are universal versus culturally or historically specific</li>
            </ul>
            
            <p><strong>Prioritization Heuristics</strong>: The strategies for determining which relationships to process first encode judgments about:</p>
            <ul>
                <li>Which relationships are most important or foundational</li>
                <li>How to balance confidence in individual relationships versus overall pedigree coherence</li>
                <li>Where to invest computational resources when they are limited</li>
            </ul>
            
            <p>These algorithmic expressions of values highlight that Bonsai is not a neutral tool but embodies specific perspectives on what matters most in understanding human relationships through genetic data.</p>

            <h3>Applications and Implications</h3>
            
            <h4>Configuring and Extending: The Politics of Customization</h4>
            <p>The systems for configuring and extending Bonsai represent a particular approach to balancing standardization with customization—a balance with significant implications for who can use the tool and for what purposes:</p>
            
            <p><strong>Configuration Systems</strong>: Bonsai's configuration approach, with nested dictionaries of parameters and defaults, encodes specific ideas about:</p>
            <ul>
                <li>Which aspects of the system should be customizable and which should remain fixed</li>
                <li>What level of technical knowledge is required to meaningfully configure the system</li>
                <li>How to balance flexibility with guarantees of correct behavior</li>
            </ul>
            
            <p>These configuration choices determine who can adjust the system to their needs and how easily they can do so.</p>
            
            <p><strong>Extension Points</strong>: The plugin architecture and API design reflect decisions about:</p>
            <ul>
                <li>Which components can be replaced or extended by users</li>
                <li>What forms of knowledge are required to create meaningful extensions</li>
                <li>How the system balances openness to extension with internal coherence</li>
            </ul>
            
            <p><strong>Documentation and Support</strong>: How the system is documented and supported shapes who can effectively use and modify it:</p>
            <ul>
                <li>Technical versus conceptual documentation balances different forms of expertise</li>
                <li>The level of detail and assumed knowledge creates implicit barriers to entry</li>
                <li>The languages and formats used for documentation privilege certain communities</li>
            </ul>
            
            <p>These aspects of configuration and extension are inherently political—they determine who has the power to shape how the tool works and what it can do. They reflect choices about who the intended users are and what forms of expertise are valued in the community around the tool.</p>

            <h4>Integration and Boundaries: Defining a Computational Ecosystem</h4>
            <p>How Bonsai integrates with other tools and defines its boundaries has significant implications for its place in the broader ecosystem of genetic analysis:</p>
            
            <p><strong>Data Formats and Interchange</strong>: The input and output formats supported by Bonsai define its relationship to other tools and datasets:</p>
            <ul>
                <li>Support for standard formats (VCF, PLINK) versus custom formats</li>
                <li>Compatibility with outputs from specific IBD detection tools</li>
                <li>Options for exporting results in various visualization formats</li>
            </ul>
            
            <p>These format choices determine which tools can easily work with Bonsai and which require additional conversion steps or adaptations.</p>
            
            <p><strong>Scope and Boundary Decisions</strong>: What Bonsai includes and excludes from its functionality reflects judgments about:</p>
            <ul>
                <li>Which aspects of genetic analysis belong together versus separate</li>
                <li>Where the tool's expertise begins and ends</li>
                <li>How specialized versus general-purpose the tool should be</li>
            </ul>
            
            <p><strong>Integration Patterns</strong>: The mechanisms for integrating with other tools define specific collaborative relationships:</p>
            <ul>
                <li>Command-line integration versus API integration versus loose coupling</li>
                <li>Sequential versus parallel processing workflows</li>
                <li>Data-centric versus service-oriented integration patterns</li>
            </ul>
            
            <p>These integration choices shape the scientific ecosystem around genetic genealogy, determining which tools can work together smoothly, which analytical workflows are easy to construct, and ultimately what kinds of questions researchers can effectively address.</p>

            <h3>Broader Context</h3>
            
            <h4>Performance and Scale: The Politics of Speed</h4>
            <p>The performance optimizations in Bonsai reflect a complex interplay between technical capabilities and social priorities:</p>
            
            <p><strong>Resource Requirements and Access</strong>: Decisions about memory usage, processing power, and optimization strategies determine who can effectively use the tool:</p>
            <ul>
                <li>High resource requirements may limit usage to well-funded institutions or researchers with access to advanced computing facilities</li>
                <li>Optimizations for consumer hardware may democratize access but potentially limit what analyses are possible</li>
                <li>The balance between specialized hardware acceleration and general compatibility reflects judgments about which users matter most</li>
            </ul>
            
            <p><strong>Scale Trade-offs</strong>: How Bonsai handles increasing dataset sizes encodes specific priorities:</p>
            <ul>
                <li>Quality versus throughput (maintaining accuracy as datasets grow)</li>
                <li>Depth versus breadth (analyzing fewer individuals more thoroughly or more individuals less thoroughly)</li>
                <li>Simplicity versus efficiency (straightforward implementations versus complex optimizations)</li>
            </ul>
            
            <p><strong>Time Valuation</strong>: Performance optimizations reflect judgments about whose time is most valuable:</p>
            <ul>
                <li>Developer time (ease of implementation and maintenance)</li>
                <li>Researcher time (waiting for results)</li>
                <li>Computer time (efficient use of computational resources)</li>
            </ul>
            
            <p>These performance considerations are inherently political—they determine who can use the tool, for what scale of problem, and at what cost. The architecture doesn't just process data faster or slower; it shapes who has access to genealogical knowledge and at what scale they can work.</p>

            <h4>Ethical Implications of Architecture</h4>
            <p>The architectural choices in Bonsai have ethical implications that go beyond technical considerations:</p>
            
            <p><strong>Data Privacy and Security</strong>: How the architecture handles sensitive genetic information reflects values about privacy:</p>
            <ul>
                <li>What data is stored, in what format, and for how long</li>
                <li>Which operations require full access to raw data versus summarized statistics</li>
                <li>How data from different individuals is isolated or combined</li>
            </ul>
            
            <p><strong>Transparency and Explainability</strong>: The architecture's approach to communicating its internal workings affects trust and accountability:</p>
            <ul>
                <li>Whether and how the system explains its inferences</li>
                <li>The visibility of underlying models and assumptions</li>
                <li>The traceability between inputs and outputs</li>
            </ul>
            
            <p><strong>Bias and Fairness</strong>: Architectural decisions can encode or mitigate biases:</p>
            <ul>
                <li>How different populations are represented in internal models</li>
                <li>Whether the system can adapt to different genetic contexts</li>
                <li>How uncertainty is handled for underrepresented groups</li>
            </ul>
            
            <p><strong>Agency and Control</strong>: The architecture determines who has control over the analysis process:</p>
            <ul>
                <li>The balance between automation and human oversight</li>
                <li>Who can configure, extend, or override the system's behavior</li>
                <li>How contestable the system's inferences are</li>
            </ul>
            
            <p>These ethical dimensions highlight that architectural choices are never merely technical—they shape who has power, knowledge, and control in the analysis of human relationships. A thoughtful architecture must consider these ethical implications alongside technical requirements.</p>

            <div class="exercises-section">
                <h3>Exercises</h3>
            <ol>
                <li>Analyze how Bonsai's architectural modularity might affect different types of users, from computer scientists to anthropologists to community members seeking to understand their family histories</li>
                <li>Consider how the configuration and extension systems might be redesigned to make them more accessible to users with different forms of expertise</li>
                <li>Identify implicit values and assumptions in the optimization algorithms, and discuss how alternative approaches might reflect different priorities</li>
                <li>Design an alternative architectural approach that would center community governance and input in the process of relationship inference</li>
                <li>Analyze the ethical implications of different approaches to performance optimization, considering issues of access, inclusivity, and representation</li>
                <li>Discuss how the architecture might evolve to better support diverse cultural understandings of kinship while maintaining scientific validity</li>
            </ol>
            </div>

            <div class="alert alert-success">
                <p><strong>Tip:</strong> When analyzing and working with computational architectures, remember that technical structures are never neutral—they encode specific values, priorities, and ways of understanding the world. By being attentive to these dimensions, we can design systems that not only work efficiently but also align with our broader ethical commitments and cultural understandings of human relationships.</p>
            </div>
            
            <h3>Interactive Lab Environment</h3>
            
            <div class="jupyter-integration">
                <p>In this lab, you'll explore Bonsai's system architecture, examining how its components work together to transform genetic data into reconstructed pedigrees.</p>
                
                <div class="jupyterlite-container">
                    
                    <div class="jupyterlite-info">
                        <h4>Browser-Based Analysis</h4>
                        <p>The notebook walks you through Bonsai's modular architecture, demonstrating how data flows through the system and how components interact during the reconstruction process.</p>
                        <ol>
                            <li>Click the "Open Lab 16 Notebook in JupyterLite" button below</li>
                            <li>In the file browser that appears, click on "<strong>Lab16_Bonsai_Architecture.ipynb</strong>" to open this lab's notebook</li>
                            <li>You can now run the code cells by clicking on them and pressing Shift+Enter</li>
                        </ol>
                        <p>Your progress is automatically saved in your browser's storage.</p>
                    </div>
                    
                    <button class="open-jupyterlite" data-lab="lab16">Open Lab 16 Notebook in JupyterLite</button>
                    
                    <div class="lab-progress" data-lab="lab16">
                        <!-- Progress will be populated by JavaScript -->
                    </div>
                </div>
                
                <div class="alert alert-info">
                    <p><strong>Note:</strong> The interactive notebook automatically loads data from previous labs if you completed them. Your work is saved in your browser's storage between lab sessions.</p>
                </div>
            </div>

            <h3>Beyond the Code</h3>
            <p>System architecture in genetic genealogy software reflects broader approaches to organizing complex information processing:</p>
            <ul>
                <li><strong>Epistemic Modularity:</strong> How compartmentalized system design reflects the division of scientific knowledge into specialized domains</li>
                <li><strong>Collaborative Development:</strong> How software architecture enables (or constrains) collaborative creation across diverse teams</li>
                <li><strong>Accessibility and Expertise:</strong> How architectural choices affect who can use, modify, and understand genetic genealogy tools</li>
                <li><strong>Future Adaptability:</strong> How system design anticipates evolving methodologies and new forms of genetic data</li>
            </ul>
            <p>These considerations highlight how software architecture embodies not just technical decisions but also values about knowledge organization, collaboration, and accessibility that shape the broader practice of computational genetic genealogy.</p>
            
            <div class="learning-pathway">
                <p>This lab is part of the Bonsai specialization track:</p>
                <div class="pathway-steps">
                    <div class="pathway-step">
                        <h5>Introduction</h5>
                        <p>Lab 11</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Fundamentals</h5>
                        <p>Lab 12</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Mathematics</h5>
                        <p>Lab 13</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Data Structures</h5>
                        <p>Lab 14</p>
                    </div>
                    <div class="pathway-step">
                        <h5>Calibration</h5>
                        <p>Lab 15</p>
                    </div>
                    <div class="pathway-step active">
                        <h5>Architecture</h5>
                        <p>Lab 16</p>
                    </div>
                    <div class="pathway-step ">
                        <h5>Likelihood</h5>
                        <p>Lab 17</p>
                    </div>
                    <div class="pathway-step ">
                        <h5>Quality</h5>
                        <p>Lab 18</p>
                    </div>
                    <div class="pathway-step ">
                        <h5>Advanced</h5>
                        <p>Lab 19</p>
                    </div>
                    <div class="pathway-step ">
                        <h5>Visualization</h5>
                        <p>Lab 20</p>
                    </div>
                    <div class="pathway-step ">
                        <h5>Applications</h5>
                        <p>Lab 21</p>
                    </div>
                </div>
            </div>
            

            <div class="lab-navigation">
                <a href="lab15_bonsai_calibration.html" class="prev-lab">Model Calibration</a>
                <a href="lab17_bonsai_likelihood.html" class="next-lab">Likelihood Calculations</a>
            </div>
        </article>
    </main>

    <footer class="textbook-footer">
        <div class="container">
            <p>&copy; 2025 Dr. LaKisha David, Department of Anthropology, University of Illinois Urbana-Champaign</p>
        </div>
    </footer>
</body>
</html>
